openapi: 3.0.0
info:
  title: Operatto API
  description: API do mini ERP Operatto
  version: 1.0.0

servers:
  - url: http://localhost:3000

tags:
  - name: Pedidos
    description: Operações relacionadas a pedidos
  - name: Estoque
    description: Operações de controle de estoque

paths:
  /pedidos/{id}/status:
    patch:
      summary: Atualizar status do pedido
      description: |
        Atualiza o status de um pedido seguindo as regras de negócio:
        - ABERTO → EM_PRODUCAO
        - EM_PRODUCAO → FINALIZADO
        - Qualquer status pode ir para CANCELADO
        - FINALIZADO não pode ser alterado
      tags:
        - Pedidos
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            example: 6
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum:
                    - ABERTO
                    - EM_PRODUCAO
                    - FINALIZADO
                    - CANCELADO
      responses:
        "200":
          description: Status atualizado com sucesso
        "400":
          description: Transição inválida
        "404":
          description: Pedido não encontrado

  /estoque/entrada:
    post:
      summary: Entrada de estoque
      description: Registra entrada manual de estoque
      tags:
        - Estoque
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_produto
                - quantidade
              properties:
                id_produto:
                  type: integer
                  example: 1
                quantidade:
                  type: integer
                  example: 50
      responses:
        "200":
          description: Entrada registrada com sucesso
        "400":
          description: Dados inválidos
          
  /estoque/baixa:
    post:
      summary: Baixa de estoque
      description: Baixa definitiva de estoque
      tags:
        - Estoque
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_produto
                - quantidade
              properties:
                id_produto:
                  type: integer
                  example: 1
                quantidade:
                  type: integer
                  example: 10
      responses:
        "200":
          description: Estoque baixado
        "400":
          description: Quantidade reservada insuficiente


